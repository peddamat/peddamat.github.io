<!DOCTYPE html><html class=no-js lang=en> <head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content="In this final series of articles, we will try to actually man-in-the-middle a Hunter Pro-HC Irrigation Controller and integrate it with Home Assistant." name=description><meta content="Sumanth " name=author peddamatham&quot; sam&quot;><link href=https://samrambles.com/projects/hunter-hacking/reverse-engineering-a-hunter-pro-hc-controller/index.html rel=canonical><link href=../hands-on-iot-mitm-part-2/index.html rel=prev><link href=../../../assets/images/favicon.png rel=icon><meta content="mkdocs-1.4.2, mkdocs-material-9.0.15" name=generator><title>Reverse Engineering A Hunter Pro HC Controller - Sam Rambles</title><link href=../../../assets/stylesheets/main.113286f1.min.css rel=stylesheet><link href=../../../assets/stylesheets/palette.a0c5b2b5.min.css rel=stylesheet><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href="https://fonts.googleapis.com/css?family=Noto+Sans:300,300i,400,400i,700,700i%7CIMB+Plex+Mono:400,400i,700,700i&display=fallback" rel=stylesheet><style>:root{--md-text-font:"Noto Sans";--md-code-font:"IMB Plex Mono"}</style><link href=../../../assets/stylesheets/extra.css rel=stylesheet><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-RZQGZXT3GC"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-RZQGZXT3GC');
</script><link href=../../../assets/stylesheets/glightbox.min.css rel=stylesheet><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            
                .gscrollbar-fixer { padding-right: 15px; }
                .gdesc-inner { font-size: 0.75rem; }
                body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
                body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
                body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
                </style><script src=../../../assets/javascripts/glightbox.min.js></script></head> <body data-md-color-accent=white data-md-color-primary=white data-md-color-scheme=white dir=ltr> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input autocomplete=off class=md-toggle data-md-toggle=drawer id=__drawer type=checkbox> <input autocomplete=off class=md-toggle data-md-toggle=search id=__search type=checkbox> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a class=md-skip href=#firmware-extraction> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <button aria-label="Don't show this again" class="md-banner__button md-icon"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg> </button> <em><b>Migration in progress:</b> apologies for broken articles and links.</em> </div> <script>var content,el=document.querySelector("[data-md-component=announce]");el&&(content=el.querySelector(".md-typeset"),__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0))</script> </aside> </div> <header class=md-header data-md-component=header> <nav aria-label=Header class="md-header__inner md-grid"> <a aria-label="Sam Rambles" class="md-header__button md-logo" data-md-component=logo href=../../../index.html title="Sam Rambles"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Sam Rambles </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Reverse Engineering A Hunter Pro HC Controller </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input aria-label="Switch to dark mode" class=md-option data-md-color-accent=white data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary=white data-md-color-scheme=white id=__palette_1 name=__palette type=radio> <label class="md-header__button md-icon" for=__palette_2 hidden title="Switch to dark mode"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"></path></svg> </label> <input aria-label="Switch to light mode" class=md-option data-md-color-accent=black data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary=black data-md-color-scheme=slate id=__palette_2 name=__palette type=radio> <label class="md-header__button md-icon" for=__palette_1 hidden title="Switch to light mode"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"></path></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input aria-label=Search autocapitalize=off autocomplete=off autocorrect=off class=md-search__input data-md-component=search-query name=query placeholder=Search required spellcheck=false type=text> <label class="md-search__icon md-icon" for=__search> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </label> <nav aria-label=Search class=md-search__options> <a aria-label=Share class="md-search__icon md-icon" data-clipboard data-clipboard-text data-md-component=search-share href=javascript:void(0) tabindex=-1 title=Share> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"></path></svg> </a> <button aria-label=Clear class="md-search__icon md-icon" tabindex=-1 title=Clear type=reset> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a class=md-source data-md-component=source href=https://github.com/peddamat/mkdocs-obsidian title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg> </div> <div class=md-source__repository> peddamat/mkdocs-obsidian </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav aria-label=Tabs class=md-tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a class=md-tabs__link href=../../../index.html> Home </a> </li> <li class=md-tabs__item> <a class=md-tabs__link href=../../../tags/index.html> Tags </a> </li> <li class=md-tabs__item> <a class=md-tabs__link href=../../../guides/index.html> Guides </a> </li> <li class=md-tabs__item> <a class=md-tabs__link href=../../../musings/my-favorite-technical-articles/index.html> Musings </a> </li> <li class=md-tabs__item> <a class=md-tabs__link href=../../../notes/index.html> Notes </a> </li> <li class=md-tabs__item> <a class="md-tabs__link md-tabs__link--active" href=../../index.html> Projects </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav aria-label=Navigation class="md-nav md-nav--primary md-nav--lifted" data-md-level=0> <label class=md-nav__title for=__drawer> <a aria-label="Sam Rambles" class="md-nav__button md-logo" data-md-component=logo href=../../../index.html title="Sam Rambles"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg> </a> Sam Rambles </label> <div class=md-nav__source> <a class=md-source data-md-component=source href=https://github.com/peddamat/mkdocs-obsidian title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg> </div> <div class=md-source__repository> peddamat/mkdocs-obsidian </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=../../../index.html> Home </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../../../tags/index.html> Tags </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_3 type=checkbox> <div class="md-nav__link md-nav__link--index"> <a href=../../../guides/index.html>Guides</a> <label for=__nav_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded=false aria-labelledby=__nav_3_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Guides </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=../../../guides/learning-networking-with-mininet/index.html> Learning Networking With Mininet </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../../../guides/writing-home-assistant-integrations/index.html> Writing Home Assistant Integrations </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../../../guides/writing-lightroom-classic-plugins/index.html> Writing Lightroom Classic Plugins </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_3_5 type=checkbox> <label class=md-nav__link for=__nav_3_5 id=__nav_3_5_label tabindex=0> Dotfiles <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_3_5_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> Dotfiles </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=../../../guides/dotfiles/how-i-overengineered-my-home-network/index.html> How I Overengineered My Home Network </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../../../guides/dotfiles/how-i-setup-this-blog/index.html> How I Setup This Blog </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../../../guides/dotfiles/how-i-write-mkdocs-plugins/index.html> How I Write MkDocs Plugins </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../../../guides/dotfiles/how-to-quickly-setup-a-wireless-mitm-proxy/index.html> How To Quickly Setup A Wireless MitM Proxy </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_3_6 type=checkbox> <label class=md-nav__link for=__nav_3_6 id=__nav_3_6_label tabindex=0> FancyZones <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_3_6_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> FancyZones </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=../../../guides/fancyzones/how-fancyzones-works/index.html> How FancyZones Works </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../../../guides/fancyzones/how-to-hack-fancyzones/index.html> How To Hack FancyZones </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_3_7 type=checkbox> <label class=md-nav__link for=__nav_3_7 id=__nav_3_7_label tabindex=0> Home DIY <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_3_7_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_3_7> <span class="md-nav__icon md-icon"></span> Home DIY </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=../../../guides/home-diy/how-to-size-a-solar-battery-install/index.html> How To Size A Solar Battery Install </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_3_8 type=checkbox> <label class=md-nav__link for=__nav_3_8 id=__nav_3_8_label tabindex=0> Window Hacking With Rust <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_3_8_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_3_8> <span class="md-nav__icon md-icon"></span> Window Hacking With Rust </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=../../../guides/window-hacking-with-rust/creating-a-dll-with-rust/index.html> Creating A DLL With Rust </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../../../guides/window-hacking-with-rust/creating-a-window-with-rust/index.html> Creating A Window With Rust </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../../../guides/window-hacking-with-rust/injecting-dlls-with-rust/index.html> Injecting DLLs With Rust </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../../../guides/window-hacking-with-rust/production-ready-dll-injection/index.html> Production Ready DLL Injection </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_4 type=checkbox> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> Musings <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_4_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Musings </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=../../../musings/my-favorite-technical-articles/index.html> My Favorite Technical Articles </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_5 type=checkbox> <div class="md-nav__link md-nav__link--index"> <a href=../../../notes/index.html>Notes</a> <label for=__nav_5> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded=false aria-labelledby=__nav_5_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Notes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=../../../notes/debugging-tools/index.html> Debugging Tools </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../../../notes/reverse-engineering-tools/index.html> Reverse Engineering Tools </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_5_4 type=checkbox> <label class=md-nav__link for=__nav_5_4 id=__nav_5_4_label tabindex=0> Cheatsheets <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_5_4_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_5_4> <span class="md-nav__icon md-icon"></span> Cheatsheets </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=../../../notes/cheatsheets/docker-cheatsheet/index.html> Docker Cheatsheet </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../../../notes/cheatsheets/git-cheatsheet/index.html> Git Cheatsheet </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../../../notes/cheatsheets/python-cheatsheet/index.html> Python Cheatsheet </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../../../notes/cheatsheets/rsync-cheatsheet/index.html> Rsync Cheatsheet </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../../../notes/cheatsheets/ruby-cheatsheet/index.html> Ruby Cheatsheet </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../../../notes/cheatsheets/tls-cheatsheet/index.html> TLS Cheatsheet </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_5_5 type=checkbox> <label class=md-nav__link for=__nav_5_5 id=__nav_5_5_label tabindex=0> Debug Probes <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_5_5_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_5_5> <span class="md-nav__icon md-icon"></span> Debug Probes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=../../../notes/debug-probes/black-magic-probe/index.html> Black Magic Probe </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../../../notes/debug-probes/segger-j-link/index.html> Segger J-Link </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_5_6 type=checkbox> <label class=md-nav__link for=__nav_5_6 id=__nav_5_6_label tabindex=0> Development Kits <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_5_6_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_5_6> <span class="md-nav__icon md-icon"></span> Development Kits </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=../../../notes/development-kits/adafruit-feather-m0-wifi/index.html> Adafruit Feather M0 WiFi </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../../../notes/development-kits/esp32/index.html> ESP32 </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../../../notes/development-kits/raspberry-pi/index.html> Raspberry Pi </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_5_6_4 type=checkbox> <div class="md-nav__link md-nav__link--index"> <a href=../../../notes/development-kits/esp8266/index.html>ESP8266</a> <label for=__nav_5_6_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded=false aria-labelledby=__nav_5_6_4_label class=md-nav data-md-level=3> <label class=md-nav__title for=__nav_5_6_4> <span class="md-nav__icon md-icon"></span> ESP8266 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=../../../notes/development-kits/esp8266/esp-01/index.html> ESP-01 </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../../../notes/development-kits/esp8266/wemos-mini/index.html> Wemos Mini </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_5_6_5 type=checkbox> <label class=md-nav__link for=__nav_5_6_5 id=__nav_5_6_5_label tabindex=0> STM32 <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_5_6_5_label class=md-nav data-md-level=3> <label class=md-nav__title for=__nav_5_6_5> <span class="md-nav__icon md-icon"></span> STM32 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=../../../notes/development-kits/stm32/black-pill/index.html> Black Pill </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../../../notes/development-kits/stm32/itead-maple/index.html> ITead Maple </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../../../notes/development-kits/stm32/super-blue-pill/index.html> Super Blue Pill </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input checked class="md-nav__toggle md-toggle" id=__nav_6 type=checkbox> <div class="md-nav__link md-nav__link--index"> <a href=../../index.html>Projects</a> <label for=__nav_6> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded=true aria-labelledby=__nav_6_label class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Projects </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_6_2 type=checkbox> <label class=md-nav__link for=__nav_6_2 id=__nav_6_2_label tabindex=0> Apps <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_6_2_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_6_2> <span class="md-nav__icon md-icon"></span> Apps </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=../../apps/introducing-recon/index.html> Introducing Recon </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../../apps/introducing-sensie/index.html> Introducing Sensie </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../../apps/serialmoose-serial-port-sniffer/index.html> SerialMoose Serial Port Sniffer </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_6_2_4 type=checkbox> <label class=md-nav__link for=__nav_6_2_4 id=__nav_6_2_4_label tabindex=0> CalibreSync <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_6_2_4_label class=md-nav data-md-level=3> <label class=md-nav__title for=__nav_6_2_4> <span class="md-nav__icon md-icon"></span> CalibreSync </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=../../apps/calibresync/calibresync-development-notes/index.html> CalibreSync Development Notes </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_6_3 type=checkbox> <label class=md-nav__link for=__nav_6_3 id=__nav_6_3_label tabindex=0> Cancer Research <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_6_3_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_6_3> <span class="md-nav__icon md-icon"></span> Cancer Research </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=../../cancer-research/generating-complete-genomics-build37-files/index.html> Generating Complete Genomics build37 Files </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../../cancer-research/target-aml-data-analysis/index.html> TARGET AML Data Analysis </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" id=__nav_6_4 type=checkbox> <label class=md-nav__link for=__nav_6_4 id=__nav_6_4_label tabindex=0> Home Assistant <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=false aria-labelledby=__nav_6_4_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_6_4> <span class="md-nav__icon md-icon"></span> Home Assistant </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=../../home-assistant/my-smart-home-devices/index.html> My Smart Home Devices </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../../home-assistant/samsung-refrigerator-integration/index.html> Samsung Refrigerator Integration </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../../home-assistant/using-pyscript-in-jupyterlab/index.html> Using Pyscript In JupyterLab </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input checked class="md-nav__toggle md-toggle" id=__nav_6_5 type=checkbox> <label class=md-nav__link for=__nav_6_5 id=__nav_6_5_label tabindex=0> Hunter Hacking <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded=true aria-labelledby=__nav_6_5_label class=md-nav data-md-level=2> <label class=md-nav__title for=__nav_6_5> <span class="md-nav__icon md-icon"></span> Hunter Hacking </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=../a-look-inside-a-hunter-pro-hc-controller/index.html> A Look Inside A Hunter Pro-HC Controller </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../atwinc1500-iot-module-deep-dive-part-1/index.html> ATWINC1500 IoT Module Deep-Dive (Part 1) </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../atwinc1500-iot-module-deep-dive-part-2/index.html> ATWINC1500 IoT Module Deep-Dive (Part 2) </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../hands-on-iot-mitm-part-1/index.html> Hands On IoT MitM (Part 1) </a> </li> <li class=md-nav__item> <a class=md-nav__link href=../hands-on-iot-mitm-part-2/index.html> Hands On IoT MitM (Part 2) </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" id=__toc type=checkbox> <label class="md-nav__link md-nav__link--active" for=__toc> Reverse Engineering A Hunter Pro HC Controller <span class="md-nav__icon md-icon"></span> </label> <a class="md-nav__link md-nav__link--active" href=index.html> Reverse Engineering A Hunter Pro HC Controller </a> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=#firmware-extraction> Firmware Extraction </a> <nav aria-label="Firmware Extraction" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#microchip-pic32mx> Microchip PIC32MX </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#microchip-atwinc1500> Microchip ATWINC1500 </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#hardware-setup> Hardware Setup </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#executing-dump> Executing Dump </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#firmware-analysis> Firmware Analysis </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#production-dry-run> Production Dry-Run </a> <nav aria-label="Production Dry-Run" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#stage-device-with-aws-iot-certs> Stage Device With AWS IoT Certs </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#validate-cert-extraction-process> Validate Cert Extraction Process </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#confirm-extracted-certificates> Confirm Extracted Certificates </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#validate-ioxy-setup> Validate IOXY Setup </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#doing-it-live> Doing it Live </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=#firmware-extraction> Firmware Extraction </a> <nav aria-label="Firmware Extraction" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#microchip-pic32mx> Microchip PIC32MX </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#microchip-atwinc1500> Microchip ATWINC1500 </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#hardware-setup> Hardware Setup </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#executing-dump> Executing Dump </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#firmware-analysis> Firmware Analysis </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#production-dry-run> Production Dry-Run </a> <nav aria-label="Production Dry-Run" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#stage-device-with-aws-iot-certs> Stage Device With AWS IoT Certs </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#validate-cert-extraction-process> Validate Cert Extraction Process </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#confirm-extracted-certificates> Confirm Extracted Certificates </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#validate-ioxy-setup> Validate IOXY Setup </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#doing-it-live> Doing it Live </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <nav class=md-tags> <a class=md-tag href=../../../tags/index.html#microchip>microchip</a> <a class=md-tag href=../../../tags/index.html#firmware>firmware</a> <a class=md-tag href=../../../tags/index.html#analysis>analysis</a> <a class=md-tag href=../../../tags/index.html#uc>uC</a> </nav> <h1>Reverse Engineering A Hunter Pro HC Controller</h1> <div><p><em>This is the final part of the <a href=../a-look-inside-a-hunter-pro-hc-controller/index.html>Hunter Hacking</a> series</em></p> <p>All right, it's been a long journey, let's take a quick survey:</p> <ul> <li> <p><a href=../a-look-inside-a-hunter-pro-hc-controller/index.html>A Look Inside A Hunter Pro-HC Controller</a></p> <p>Here we discovered the Hunter Pro-HC Irrigation controller uses the Microchip ATWINC1500 IoT module as part of its architectural design. We also learned that the controller communicates with backend services on Amazon using MQTTS on port 8883.</p> </li> <li> <p><a href=../atwinc1500-iot-module-deep-dive-part-1/index.html>ATWINC1500 IoT Module Deep-Dive (Part 1)</a></p> <p>Here we learned that the ATWINC1500 has easily accessible debug interfaces which allow firmware extraction. We also learned that the module stores Root CA certificates in its Root Cert Store and TLS certificates in its TLS Server Store.</p> </li> <li> <p><a href=../atwinc1500-iot-module-deep-dive-part-2/index.html>ATWINC1500 IoT Module Deep-Dive (Part 2)</a></p> <p>Here we modify the Microchip-supplied ATWINC1500 tools to allow dumping and modification of the Root Cert Store and TLS Server Store contents.</p> </li> <li> <p><a href=../hands-on-iot-mitm-part-1/index.html>Hands On IoT MitM (Part 1)</a></p> <p>Here we learn about intercepting traffic between ATWINC1500-based IoT devices and Amazon AWS IoT.</p> </li> <li> <p><a href=../hands-on-iot-mitm-part-2/index.html>Hands On IoT MitM (Part 2)</a></p> <p>Here we actually intercept traffic between an ATWINC1500-based IoT device and Amazon AWS IoT.</p> </li> </ul> <p>In this final series of articles, we will try to actually man-in-the-middle the Hunter Pro-HC Irrigation Controller and integrate it with Home Assistant.</p> <hr> <h2 id=firmware-extraction>Firmware Extraction<a class=headerlink href=#firmware-extraction title="Permanent link">¶</a></h2> <h3 id=microchip-pic32mx>Microchip PIC32MX<a class=headerlink href=#microchip-pic32mx title="Permanent link">¶</a></h3> <p>The microcontroller is code protected:</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../../../assets/images/pasted-image-20230326070535.png><img alt="Pasted image 20230326070535.png" src=../../../assets/images/pasted-image-20230326070535.png width=700></a></p> <h3 id=microchip-atwinc1500>Microchip ATWINC1500<a class=headerlink href=#microchip-atwinc1500 title="Permanent link">¶</a></h3> <p>The first thing we'll need to do is dump the Hunter Pro-HC's firmware so we can extract the device's private key and certificate. </p> <h3 id=hardware-setup>Hardware Setup<a class=headerlink href=#hardware-setup title="Permanent link">¶</a></h3> <p>I'm going to use the same steps we used in <a href=../atwinc1500-iot-module-deep-dive-part-1/index.html#firmware-extraction>Firmware Extraction</a> with the board outs from <a href=../a-look-inside-a-hunter-pro-hc-controller/index.html#board-outs>Board Outs</a>.</p> <p>Tie the MCLR to 3.3V and power up the board.</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../../../assets/images/pasted-image-20230321012439.png><img alt="Pasted image 20230321012439.png" src=../../../assets/images/pasted-image-20230321012439.png width=300></a> <a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../../../assets/images/pasted-image-20230326165641.png><img alt="Pasted image 20230326165641.png" src=../../../assets/images/pasted-image-20230326165641.png width=340></a> </p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../../../assets/images/pasted-image-20230313162712.png><img alt="Pasted image 20230313162712.png" src=../../../assets/images/pasted-image-20230313162712.png width=300></a></p> <h3 id=executing-dump>Executing Dump<a class=headerlink href=#executing-dump title="Permanent link">¶</a></h3> <div class="language-bash highlight"><span class=filename>Hunter Pro-HC</span><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a>$<span class=w> </span>winc_programmer_uart.exe<span class=w> </span>-p<span class=w> </span>COM4<span class=w> </span>-d<span class=w> </span>winc1500<span class=w> </span>-r<span class=w> </span>-pfw<span class=w> </span>programmer_firmware.bin<span class=w> </span>-o<span class=w> </span>atwinc1500-hunter.bin
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>WINC<span class=w> </span>Programming<span class=w> </span>Tool<span class=w> </span><span class=m>2</span>.0.1<span class=w> </span><span class=o>[</span>ceebe5f<span class=o>]</span><span class=w> </span><span class=o>(</span>Apr<span class=w> </span><span class=m>20</span><span class=w> </span><span class=m>2022</span><span class=o>)</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>Copyright<span class=w> </span><span class=o>(</span>C<span class=o>)</span><span class=w> </span>Microchip<span class=w> </span>Technology<span class=w> </span>Inc.<span class=w> </span><span class=m>2022</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>hardware<span class=w> </span>WINC<span class=w> </span>serial<span class=w> </span>bridge<span class=w> </span>found
</span><span id=__span-0-6><a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>chip<span class=w> </span>ID<span class=w> </span>is<span class=w> </span>0x001503a0
</span><span id=__span-0-7><a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>programming<span class=w> </span>firmware<span class=w> </span>file:<span class=w> </span>programmer_firmware.bin
</span><span id=__span-0-8><a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>reinitialise<span class=w> </span>onchip<span class=w> </span>uart<span class=w> </span>to<span class=w> </span><span class=m>500000</span>
</span><span id=__span-0-9><a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>waiting<span class=w> </span><span class=k>for</span><span class=w> </span>firmware<span class=w> </span>to<span class=w> </span>run
</span><span id=__span-0-10><a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>flash<span class=w> </span>ID<span class=w> </span>0xc21320c2
</span><span id=__span-0-11><a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>flash<span class=w> </span>size<span class=w> </span>is<span class=w> </span><span class=m>4</span><span class=w> </span>Mb
</span><span id=__span-0-12><a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>
</span><span id=__span-0-13><a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>begin<span class=w> </span><span class=nb>read</span><span class=w> </span>operation
</span><span id=__span-0-14><a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>
</span><span id=__span-0-15><a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a><span class=w> </span>0x000000:<span class=o>[</span>rrrrrrrr<span class=o>]</span><span class=w> </span>0x008000:<span class=o>[</span>rrrrrrrr<span class=o>]</span><span class=w> </span>0x010000:<span class=o>[</span>rrrrrrrr<span class=o>]</span><span class=w> </span>0x018000:<span class=o>[</span>rrrrrrrr<span class=o>]</span>
</span><span id=__span-0-16><a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a><span class=w> </span>0x020000:<span class=o>[</span>rrrrrrrr<span class=o>]</span><span class=w> </span>0x028000:<span class=o>[</span>rrrrrrrr<span class=o>]</span><span class=w> </span>0x030000:<span class=o>[</span>rrrrrrrr<span class=o>]</span><span class=w> </span>0x038000:<span class=o>[</span>rrrrrrrr<span class=o>]</span>
</span><span id=__span-0-17><a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a><span class=w> </span>0x040000:<span class=o>[</span>rrrrrrrr<span class=o>]</span><span class=w> </span>0x048000:<span class=o>[</span>rrrrrrrr<span class=o>]</span><span class=w> </span>0x050000:<span class=o>[</span>rrrrrrrr<span class=o>]</span><span class=w> </span>0x058000:<span class=o>[</span>rrrrrrrr<span class=o>]</span>
</span><span id=__span-0-18><a href=#__codelineno-0-18 id=__codelineno-0-18 name=__codelineno-0-18></a><span class=w> </span>0x060000:<span class=o>[</span>rrrrrrrr<span class=o>]</span><span class=w> </span>0x068000:<span class=o>[</span>rrrrrrrr<span class=o>]</span><span class=w> </span>0x070000:<span class=o>[</span>rrrrrrrr<span class=o>]</span><span class=w> </span>0x078000:<span class=o>[</span>rrrrrrrr<span class=o>]</span>
</span><span id=__span-0-19><a href=#__codelineno-0-19 id=__codelineno-0-19 name=__codelineno-0-19></a>
</span><span id=__span-0-20><a href=#__codelineno-0-20 id=__codelineno-0-20 name=__codelineno-0-20></a>output<span class=w> </span>file<span class=w> </span>format<span class=w> </span>not<span class=w> </span>specified,<span class=w> </span>assuming<span class=w> </span><span class=s1>'raw'</span>
</span></code></pre></div> <div class="admonition info"> <p class=admonition-title>Having trouble?</p> <p>It took me a ~15 tries to get the dump to work. Here are some tips: - Make sure you're powering the board with 3.3V - Make sure you're supplying enough power to the board - Try disconnecting the display flex cable - Try manually trying the ATWINC1500 <code>RESET_N</code> pin high - Pray</p> </div> <hr> <h2 id=firmware-analysis>Firmware Analysis<a class=headerlink href=#firmware-analysis title="Permanent link">¶</a></h2> <p>We can now dump the Root Cert Store and TLS Server Store contents using:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-1-1><a href=#__codelineno-1-1 id=__codelineno-1-1 name=__codelineno-1-1></a>$<span class=w> </span>atwinc1500_fwtool.exe<span class=w> </span><span class=nb>read</span><span class=w> </span>atwinc1500-hunter.bin<span class=w> </span>-o<span class=w> </span>output-hunter
</span><span id=__span-1-2><a href=#__codelineno-1-2 id=__codelineno-1-2 name=__codelineno-1-2></a>
</span><span id=__span-1-3><a href=#__codelineno-1-3 id=__codelineno-1-3 name=__codelineno-1-3></a>Dumping<span class=w> </span>TLS<span class=w> </span>Store<span class=w> </span>contents...
</span><span id=__span-1-4><a href=#__codelineno-1-4 id=__codelineno-1-4 name=__codelineno-1-4></a>-<span class=w> </span>TLS<span class=w> </span>Certificate<span class=w> </span>Store<span class=w> </span>Loaded<span class=w> </span>Successfully<span class=w> </span>From:<span class=w> </span>Firmware<span class=w> </span>Image
</span><span id=__span-1-5><a href=#__codelineno-1-5 id=__codelineno-1-5 name=__codelineno-1-5></a>Found<span class=w> </span><span class=m>3</span><span class=w> </span>entries...
</span><span id=__span-1-6><a href=#__codelineno-1-6 id=__codelineno-1-6 name=__codelineno-1-6></a>-<span class=w> </span>RSA<span class=w> </span>Certificate<span class=w> </span>Chain<span class=w> </span>File<span class=w> </span>List
</span><span id=__span-1-7><a href=#__codelineno-1-7 id=__codelineno-1-7 name=__codelineno-1-7></a><span class=w>  </span>NAME<span class=w>                                             </span>SIZE<span class=w> </span>TYPE<span class=w>         </span>INFO
</span><span id=__span-1-8><a href=#__codelineno-1-8 id=__codelineno-1-8 name=__codelineno-1-8></a><span class=w>  </span>PRIV_00ecf54963945448ad3fe767799ed084f6b2befda4<span class=w>  </span><span class=m>1208</span><span class=w> </span>PRIVATE<span class=w> </span>KEY
</span><span id=__span-1-9><a href=#__codelineno-1-9 id=__codelineno-1-9 name=__codelineno-1-9></a><span class=w>  </span>CERT_00ecf54963945448ad3fe767799ed084f6b2befda4<span class=w>   </span><span class=m>862</span><span class=w> </span>CERTIFICATE<span class=w>  </span>AWS<span class=w> </span>IoT<span class=w> </span>Certificate
</span><span id=__span-1-10><a href=#__codelineno-1-10 id=__codelineno-1-10 name=__codelineno-1-10></a>-<span class=w> </span>Private<span class=w> </span>Key<span class=w> </span>Details:
</span><span id=__span-1-11><a href=#__codelineno-1-11 id=__codelineno-1-11 name=__codelineno-1-11></a><span class=w>  </span>Modulus<span class=w> </span><span class=o>(</span>N<span class=o>)</span><span class=w> </span>:<span class=o>(</span>015430B4<span class=o>)(</span><span class=m>256</span><span class=o>)</span>
</span><span id=__span-1-12><a href=#__codelineno-1-12 id=__codelineno-1-12 name=__codelineno-1-12></a><span class=w>        </span>D1<span class=w> </span>CD<span class=w> </span>2B<span class=w> </span>BD<span class=w> </span>DA<span class=w> </span>A8<span class=w> </span>2E<span class=w> </span><span class=m>05</span><span class=w> </span>E3<span class=w> </span>DA<span class=w> </span>D6<span class=w> </span>1A<span class=w> </span>D0<span class=w> </span>B9<span class=w> </span>8E<span class=w> </span><span class=m>50</span>
</span><span id=__span-1-13><a href=#__codelineno-1-13 id=__codelineno-1-13 name=__codelineno-1-13></a><span class=w>        </span><span class=m>06</span><span class=w> </span>DB<span class=w> </span><span class=m>67</span><span class=w> </span>E1<span class=w> </span>E2<span class=w> </span><span class=m>74</span><span class=w> </span><span class=m>64</span><span class=w> </span>0A<span class=w> </span>E0<span class=w> </span><span class=m>82</span><span class=w> </span><span class=m>88</span><span class=w> </span><span class=m>89</span><span class=w> </span>C5<span class=w> </span><span class=m>06</span><span class=w> </span>BA<span class=w> </span>C8
</span><span id=__span-1-14><a href=#__codelineno-1-14 id=__codelineno-1-14 name=__codelineno-1-14></a><span class=w>        </span>EB<span class=w> </span>4B<span class=w> </span>A0<span class=w> </span>1D<span class=w> </span><span class=m>99</span><span class=w> </span><span class=m>68</span><span class=w> </span><span class=m>85</span><span class=w> </span>CE<span class=w> </span><span class=m>16</span><span class=w> </span>E0<span class=w> </span>A9<span class=w> </span>8C<span class=w> </span>9E<span class=w> </span><span class=m>02</span><span class=w> </span><span class=m>11</span><span class=w> </span><span class=m>70</span>
</span><span id=__span-1-15><a href=#__codelineno-1-15 id=__codelineno-1-15 name=__codelineno-1-15></a><span class=w>        </span>F9<span class=w> </span><span class=m>72</span><span class=w> </span><span class=m>70</span><span class=w> </span>D1<span class=w> </span>C4<span class=w> </span>2A<span class=w> </span><span class=m>31</span><span class=w> </span>A8<span class=w> </span>BA<span class=w> </span><span class=m>99</span><span class=w> </span><span class=m>82</span><span class=w> </span><span class=m>94</span><span class=w> </span>5F<span class=w> </span>3B<span class=w> </span>F8<span class=w> </span>1C
</span><span id=__span-1-16><a href=#__codelineno-1-16 id=__codelineno-1-16 name=__codelineno-1-16></a><span class=w>        </span><span class=m>81</span><span class=w> </span>FB<span class=w> </span><span class=m>27</span><span class=w> </span><span class=m>69</span><span class=w> </span><span class=m>02</span><span class=w> </span>2B<span class=w> </span>DF<span class=w> </span>6A<span class=w> </span>5F<span class=w> </span><span class=m>31</span><span class=w> </span><span class=m>46</span><span class=w> </span><span class=m>80</span><span class=w> </span>FE<span class=w> </span><span class=m>87</span><span class=w> </span><span class=m>32</span><span class=w> </span>DF
</span><span id=__span-1-17><a href=#__codelineno-1-17 id=__codelineno-1-17 name=__codelineno-1-17></a><span class=w>        </span><span class=m>54</span><span class=w> </span><span class=m>96</span><span class=w> </span>B2<span class=w> </span><span class=m>12</span><span class=w> </span>F6<span class=w> </span>F6<span class=w> </span>B4<span class=w> </span>B2<span class=w> </span>CB<span class=w> </span>9E<span class=w> </span>EA<span class=w> </span><span class=m>45</span><span class=w> </span>E4<span class=w> </span>1A<span class=w> </span>A6<span class=w> </span>DF
</span><span id=__span-1-18><a href=#__codelineno-1-18 id=__codelineno-1-18 name=__codelineno-1-18></a><span class=w>        </span>AB<span class=w> </span><span class=m>93</span><span class=w> </span><span class=m>25</span><span class=w> </span><span class=m>27</span><span class=w> </span>C0<span class=w> </span><span class=m>77</span><span class=w> </span>F0<span class=w> </span>6C<span class=w> </span>AF<span class=w> </span>C5<span class=w> </span><span class=m>40</span><span class=w> </span><span class=m>42</span><span class=w> </span><span class=m>90</span><span class=w> </span><span class=m>87</span><span class=w> </span>EE<span class=w> </span>7F
</span><span id=__span-1-19><a href=#__codelineno-1-19 id=__codelineno-1-19 name=__codelineno-1-19></a><span class=w>        </span>0C<span class=w> </span>DD<span class=w> </span>F8<span class=w> </span>BC<span class=w> </span><span class=m>78</span><span class=w> </span>CE<span class=w> </span><span class=m>79</span><span class=w> </span>C6<span class=w> </span>B5<span class=w> </span><span class=m>91</span><span class=w> </span><span class=m>50</span><span class=w> </span><span class=m>63</span><span class=w> </span>6E<span class=w> </span>B6<span class=w> </span>8D<span class=w> </span>3D
</span><span id=__span-1-20><a href=#__codelineno-1-20 id=__codelineno-1-20 name=__codelineno-1-20></a><span class=w>        </span>A4<span class=w> </span>6D<span class=w> </span>E2<span class=w> </span>3D<span class=w> </span>9A<span class=w> </span><span class=m>84</span><span class=w> </span>ED<span class=w> </span><span class=m>39</span><span class=w> </span>BB<span class=w> </span>A9<span class=w> </span><span class=m>04</span><span class=w> </span>ED<span class=w> </span>6E<span class=w> </span><span class=m>34</span><span class=w> </span><span class=m>22</span><span class=w> </span>0E
</span><span id=__span-1-21><a href=#__codelineno-1-21 id=__codelineno-1-21 name=__codelineno-1-21></a><span class=w>        </span>F3<span class=w> </span>F4<span class=w> </span>2C<span class=w> </span><span class=m>14</span><span class=w> </span>EB<span class=w> </span>CD<span class=w> </span><span class=m>94</span><span class=w> </span>2A<span class=w> </span><span class=m>99</span><span class=w> </span>D9<span class=w> </span>D7<span class=w> </span>F3<span class=w> </span><span class=m>73</span><span class=w> </span>3D<span class=w> </span><span class=m>16</span><span class=w> </span>BD
</span><span id=__span-1-22><a href=#__codelineno-1-22 id=__codelineno-1-22 name=__codelineno-1-22></a><span class=w>        </span><span class=m>25</span><span class=w> </span><span class=m>20</span><span class=w> </span>B4<span class=w> </span><span class=m>84</span><span class=w> </span><span class=m>89</span><span class=w> </span>4D<span class=w> </span><span class=m>47</span><span class=w> </span>3F<span class=w> </span>E7<span class=w> </span>F4<span class=w> </span>E8<span class=w> </span>DA<span class=w> </span>A4<span class=w> </span>E0<span class=w> </span><span class=m>41</span><span class=w> </span><span class=m>05</span>
</span><span id=__span-1-23><a href=#__codelineno-1-23 id=__codelineno-1-23 name=__codelineno-1-23></a><span class=w>        </span>CB<span class=w> </span>C6<span class=w> </span>7F<span class=w> </span><span class=m>42</span><span class=w> </span>C6<span class=w> </span><span class=m>18</span><span class=w> </span>BA<span class=w> </span>EC<span class=w> </span><span class=m>33</span><span class=w> </span><span class=m>56</span><span class=w> </span><span class=m>12</span><span class=w> </span><span class=m>16</span><span class=w> </span>7F<span class=w> </span>A4<span class=w> </span><span class=m>38</span><span class=w> </span>E4
</span><span id=__span-1-24><a href=#__codelineno-1-24 id=__codelineno-1-24 name=__codelineno-1-24></a><span class=w>        </span><span class=m>96</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>13</span><span class=w> </span><span class=m>13</span><span class=w> </span>4D<span class=w> </span>DF<span class=w> </span><span class=m>23</span><span class=w> </span>9F<span class=w> </span>D4<span class=w> </span>FD<span class=w> </span>4E<span class=w> </span><span class=m>21</span><span class=w> </span>BA<span class=w> </span>B7<span class=w> </span>8A<span class=w> </span>6B
</span><span id=__span-1-25><a href=#__codelineno-1-25 id=__codelineno-1-25 name=__codelineno-1-25></a><span class=w>        </span>5B<span class=w> </span><span class=m>44</span><span class=w> </span>FF<span class=w> </span><span class=m>37</span><span class=w> </span><span class=m>62</span><span class=w> </span><span class=m>30</span><span class=w> </span>B6<span class=w> </span><span class=m>97</span><span class=w> </span><span class=m>00</span><span class=w> </span>EA<span class=w> </span>CD<span class=w> </span>2E<span class=w> </span><span class=m>52</span><span class=w> </span><span class=m>93</span><span class=w> </span>EF<span class=w> </span><span class=m>51</span>
</span><span id=__span-1-26><a href=#__codelineno-1-26 id=__codelineno-1-26 name=__codelineno-1-26></a><span class=w>        </span><span class=m>85</span><span class=w> </span>F6<span class=w> </span>8B<span class=w> </span>B3<span class=w> </span>E0<span class=w> </span>4D<span class=w> </span><span class=m>97</span><span class=w> </span>9E<span class=w> </span><span class=m>87</span><span class=w> </span>BE<span class=w> </span>E9<span class=w> </span>DB<span class=w> </span>C4<span class=w> </span><span class=m>89</span><span class=w> </span><span class=m>84</span><span class=w> </span>E6
</span><span id=__span-1-27><a href=#__codelineno-1-27 id=__codelineno-1-27 name=__codelineno-1-27></a><span class=w>        </span><span class=m>90</span><span class=w> </span><span class=m>88</span><span class=w> </span><span class=m>80</span><span class=w> </span>D5<span class=w> </span><span class=m>18</span><span class=w> </span><span class=m>71</span><span class=w> </span><span class=m>21</span><span class=w> </span><span class=m>84</span><span class=w> </span>5E<span class=w> </span><span class=m>92</span><span class=w> </span><span class=m>41</span><span class=w> </span><span class=m>46</span><span class=w> </span>4B<span class=w> </span><span class=m>70</span><span class=w> </span><span class=m>42</span><span class=w> </span><span class=m>55</span>
</span><span id=__span-1-28><a href=#__codelineno-1-28 id=__codelineno-1-28 name=__codelineno-1-28></a>
</span><span id=__span-1-29><a href=#__codelineno-1-29 id=__codelineno-1-29 name=__codelineno-1-29></a>Dumping<span class=w> </span>Root<span class=w> </span>Cert<span class=w> </span>Store<span class=w> </span>contents...
</span><span id=__span-1-30><a href=#__codelineno-1-30 id=__codelineno-1-30 name=__codelineno-1-30></a>-<span class=w> </span>Root<span class=w> </span>Certificate<span class=w> </span>Store<span class=w> </span>Loaded<span class=w> </span>Successfully<span class=w> </span>From:<span class=w> </span>Firmware<span class=w> </span>Image
</span><span id=__span-1-31><a href=#__codelineno-1-31 id=__codelineno-1-31 name=__codelineno-1-31></a>-<span class=w> </span>Found<span class=w> </span><span class=m>3</span><span class=w> </span>entries:
</span><span id=__span-1-32><a href=#__codelineno-1-32 id=__codelineno-1-32 name=__codelineno-1-32></a><span class=m>1</span><span class=o>)</span><span class=w> </span>RSA<span class=w> </span>Certificate:<span class=w> </span><span class=m>11</span>/8/2006<span class=w> </span><span class=o>[</span><span class=m>00</span>:00:00<span class=o>]</span><span class=w> </span>to<span class=w> </span><span class=m>7</span>/16/2036<span class=w> </span><span class=o>[</span><span class=m>23</span>:59:59<span class=o>]</span>
</span><span id=__span-1-33><a href=#__codelineno-1-33 id=__codelineno-1-33 name=__codelineno-1-33></a><span class=w>   </span>Name<span class=w> </span>Hash<span class=w> </span><span class=o>(</span>SHA1<span class=o>)</span>:<span class=w> </span>B8<span class=w> </span>0D<span class=w> </span>5E<span class=w> </span>D3<span class=w> </span><span class=m>51</span><span class=w> </span><span class=m>52</span><span class=w> </span>3F<span class=w> </span>ED<span class=w> </span><span class=m>85</span><span class=w> </span><span class=m>37</span><span class=w> </span><span class=m>20</span><span class=w> </span>A0<span class=w> </span>AC<span class=w> </span>C0<span class=w> </span>DC<span class=w> </span><span class=m>13</span><span class=w> </span><span class=m>77</span><span class=w> </span>BE<span class=w> </span><span class=m>16</span><span class=w> </span>0C
</span><span id=__span-1-34><a href=#__codelineno-1-34 id=__codelineno-1-34 name=__codelineno-1-34></a><span class=m>2</span><span class=o>)</span><span class=w> </span>RSA<span class=w> </span>Certificate:<span class=w> </span><span class=m>5</span>/26/2015<span class=w> </span><span class=o>[</span><span class=m>00</span>:00:00<span class=o>]</span><span class=w> </span>to<span class=w> </span><span class=m>1</span>/17/2038<span class=w> </span><span class=o>[</span><span class=m>00</span>:00:00<span class=o>]</span>
</span><span id=__span-1-35><a href=#__codelineno-1-35 id=__codelineno-1-35 name=__codelineno-1-35></a><span class=w>   </span>Name<span class=w> </span>Hash<span class=w> </span><span class=o>(</span>SHA1<span class=o>)</span>:<span class=w> </span>A8<span class=w> </span><span class=m>66</span><span class=w> </span><span class=m>80</span><span class=w> </span>C4<span class=w> </span><span class=m>56</span><span class=w> </span><span class=m>27</span><span class=w> </span>2E<span class=w> </span>AF<span class=w> </span>E3<span class=w> </span>A7<span class=w> </span>CE<span class=w> </span>2E<span class=w> </span><span class=m>49</span><span class=w> </span>D1<span class=w> </span><span class=m>31</span><span class=w> </span>DC<span class=w> </span><span class=m>65</span><span class=w> </span>BB<span class=w> </span>B1<span class=w> </span>ED
</span><span id=__span-1-36><a href=#__codelineno-1-36 id=__codelineno-1-36 name=__codelineno-1-36></a><span class=m>3</span><span class=o>)</span><span class=w> </span>RSA<span class=w> </span>Certificate:<span class=w> </span><span class=m>5</span>/26/2015<span class=w> </span><span class=o>[</span><span class=m>00</span>:00:00<span class=o>]</span><span class=w> </span>to<span class=w> </span><span class=m>5</span>/26/2040<span class=w> </span><span class=o>[</span><span class=m>00</span>:00:00<span class=o>]</span>
</span><span id=__span-1-37><a href=#__codelineno-1-37 id=__codelineno-1-37 name=__codelineno-1-37></a><span class=w>   </span>Name<span class=w> </span>Hash<span class=w> </span><span class=o>(</span>SHA1<span class=o>)</span>:<span class=w> </span>1A<span class=w> </span><span class=m>49</span><span class=w> </span>C7<span class=w> </span><span class=m>63</span><span class=w> </span><span class=m>82</span><span class=w> </span>3A<span class=w> </span>9E<span class=w> </span>3F<span class=w> </span><span class=m>53</span><span class=w> </span>2D<span class=w> </span>F1<span class=w> </span>BA<span class=w> </span>1F<span class=w> </span>BF<span class=w> </span>7E<span class=w> </span>B0<span class=w> </span><span class=m>13</span><span class=w> </span>0F<span class=w> </span>BB<span class=w> </span>1A
</span></code></pre></div> <p>Which results in:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-2-1><a href=#__codelineno-2-1 id=__codelineno-2-1 name=__codelineno-2-1></a>$<span class=w> </span>tree<span class=w> </span>-a<span class=w> </span>-L<span class=w> </span><span class=m>3</span>
</span><span id=__span-2-2><a href=#__codelineno-2-2 id=__codelineno-2-2 name=__codelineno-2-2></a>.
</span><span id=__span-2-3><a href=#__codelineno-2-3 id=__codelineno-2-3 name=__codelineno-2-3></a>├──<span class=w> </span>RSA_AWS<span class=w> </span>IoT<span class=w> </span>Certificate.cer
</span><span id=__span-2-4><a href=#__codelineno-2-4 id=__codelineno-2-4 name=__codelineno-2-4></a>├──<span class=w> </span>private-key.asn1
</span><span id=__span-2-5><a href=#__codelineno-2-5 id=__codelineno-2-5 name=__codelineno-2-5></a>├──<span class=w> </span>private-key.bat
</span><span id=__span-2-6><a href=#__codelineno-2-6 id=__codelineno-2-6 name=__codelineno-2-6></a>├──<span class=w> </span>public-key.bat
</span><span id=__span-2-7><a href=#__codelineno-2-7 id=__codelineno-2-7 name=__codelineno-2-7></a>├──<span class=w> </span>public-rsa-cert-01.asn1
</span><span id=__span-2-8><a href=#__codelineno-2-8 id=__codelineno-2-8 name=__codelineno-2-8></a>├──<span class=w> </span>public-rsa-cert-02.asn1
</span><span id=__span-2-9><a href=#__codelineno-2-9 id=__codelineno-2-9 name=__codelineno-2-9></a>└──<span class=w> </span>public-rsa-cert-03.asn1
</span></code></pre></div> <p>It looks like we have the device's private key named <code>private-key</code> and certificate named <code>RSA_AWS IoT Certificate.cer</code>.</p> <p>Spidey senses tingling? Yep, feels familar: <a href=../hands-on-iot-mitm-part-1/index.html#3-basic-mqtts-connection>Hands On IoT MitM (Part 1)#3. Basic MQTTS Connection</a>.</p> <p>Here's what the two look like side-by-side:</p> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../../../assets/images/pasted-image-20230326011055.png><img alt="Pasted image 20230326011055.png" src=../../../assets/images/pasted-image-20230326011055.png width=300></a> <a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=100% href=../../../assets/images/pasted-image-20230326011156.png><img alt="Pasted image 20230326011156.png" src=../../../assets/images/pasted-image-20230326011156.png width=300></a> </p> <p>At this point, we can be 99% certain that the Hunter Pro HC is using vanilla AWS IoT as its backend service.</p> <div class="admonition info"> <p class=admonition-title>Is this legal?</p> <p>IANAL, so I'll only speak to technical aspects, but having the private key and certificate in no-way gives us, or our Hunter Pro-HC controller, any "more" access to Hunter's AWS IoT backend services than we had before we extracted them.</p> </div> <p>Convert:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-3-1><a href=#__codelineno-3-1 id=__codelineno-3-1 name=__codelineno-3-1></a>openssl<span class=w> </span>x509<span class=w> </span>-inform<span class=w> </span>der<span class=w> </span>-in<span class=w> </span>RSA_AWSIoTCertificate.cer<span class=w> </span>-out<span class=w> </span>RSA_AWSIoTCertificate.pem
</span></code></pre></div> <hr> <h2 id=production-dry-run>Production Dry-Run<a class=headerlink href=#production-dry-run title="Permanent link">¶</a></h2> <p>Now that we're at the precipice of MitM'ing our Hunter Pro-HC, it's worth doing a dry-run of what we're going to be doing to our device:</p> <ol> <li>Starting from <a href=../hands-on-iot-mitm-part-1/index.html#iot-device-setup>Hands On IoT MitM (Part 1)#IoT Device Setup</a>, we will start with "IoT Device" which connects directly to Amazon IoT.</li> <li>We will extract the contents of the Root Cert Store and TLS Server Store</li> <li>We will use the extracted AWS IoT private key, certificate, and Root CA certificate to configure IOXY</li> <li>We will generate and burn the IOXY verification certs to the Root Cert Store and TLS Server Store </li> <li>We will confirm that the device connects to AWS IoT</li> </ol> <hr> <h3 id=stage-device-with-aws-iot-certs>Stage Device With AWS IoT Certs<a class=headerlink href=#stage-device-with-aws-iot-certs title="Permanent link">¶</a></h3> <ol> <li>Upload SerialBridge sketch to device</li> <li> <p>Clear out the device</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-4-1><a href=#__codelineno-4-1 id=__codelineno-4-1 name=__codelineno-4-1></a>$<span class=w> </span>atwinc1500_fwtool.exe<span class=w> </span>erase<span class=w> </span>--root<span class=w> </span>--tls
</span></code></pre></div> </li> <li> <p>Upload AWS IoT certs</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-5-1><a href=#__codelineno-5-1 id=__codelineno-5-1 name=__codelineno-5-1></a><span class=c1># Write AWS IoT private key and certificate to TLS Server Store</span>
</span><span id=__span-5-2><a href=#__codelineno-5-2 id=__codelineno-5-2 name=__codelineno-5-2></a>$<span class=w> </span>atwinc1500_fwtool.exe<span class=w> </span>update<span class=w> </span>--tls<span class=w> </span>--key<span class=w> </span>connect_device_package<span class=se>\f</span>eathermitm.private.key<span class=w> </span>--cert<span class=w> </span>connect_device_package<span class=se>\f</span>eathermitm.cert.pem
</span><span id=__span-5-3><a href=#__codelineno-5-3 id=__codelineno-5-3 name=__codelineno-5-3></a>
</span><span id=__span-5-4><a href=#__codelineno-5-4 id=__codelineno-5-4 name=__codelineno-5-4></a><span class=w> </span><span class=c1># Write AWS Root CA cert to Root Cert Store</span>
</span><span id=__span-5-5><a href=#__codelineno-5-5 id=__codelineno-5-5 name=__codelineno-5-5></a>$<span class=w> </span>atwinc1500_fwtool.exe<span class=w> </span>update<span class=w> </span>--root<span class=w> </span>--ca_dir<span class=w> </span>connect_device_package
</span></code></pre></div> </li> <li> <p>Confirm AWS IoT Connectivity using AWS_IoT_WiFi sketch</p> </li> </ol> <hr> <h3 id=validate-cert-extraction-process>Validate Cert Extraction Process<a class=headerlink href=#validate-cert-extraction-process title="Permanent link">¶</a></h3> <ol> <li>Upload SerialBridge sketch to device</li> <li> <p>Extract certificates</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-6-1><a href=#__codelineno-6-1 id=__codelineno-6-1 name=__codelineno-6-1></a>$<span class=w> </span>mkdir<span class=w> </span>output-dryrun
</span><span id=__span-6-2><a href=#__codelineno-6-2 id=__codelineno-6-2 name=__codelineno-6-2></a>$<span class=w> </span>atwinc1500_fwtool.exe<span class=w> </span><span class=nb>read</span><span class=w> </span>-o<span class=w> </span>output-dryrun
</span></code></pre></div> </li> <li> <p>Examine the certificates</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-7-1><a href=#__codelineno-7-1 id=__codelineno-7-1 name=__codelineno-7-1></a>$ ls -l
</span><span id=__span-7-2><a href=#__codelineno-7-2 id=__codelineno-7-2 name=__codelineno-7-2></a>
</span><span id=__span-7-3><a href=#__codelineno-7-3 id=__codelineno-7-3 name=__codelineno-7-3></a>private-key.asn1
</span><span id=__span-7-4><a href=#__codelineno-7-4 id=__codelineno-7-4 name=__codelineno-7-4></a>private-key.bat
</span><span id=__span-7-5><a href=#__codelineno-7-5 id=__codelineno-7-5 name=__codelineno-7-5></a>public-key.bat
</span><span id=__span-7-6><a href=#__codelineno-7-6 id=__codelineno-7-6 name=__codelineno-7-6></a>public-rsa-cert-01.asn1
</span><span id=__span-7-7><a href=#__codelineno-7-7 id=__codelineno-7-7 name=__codelineno-7-7></a>RSA_AWS IoT Certificate.cer
</span></code></pre></div> </li> </ol> <div class="admonition note"> <p class=admonition-title>Note</p> <p><code>RSA_AWS IoT Certificate.cer</code> is the AWS IoT device cert.</p> </div> <ol start=4> <li> <p>Convert certificates to <code>.der</code></p> <p><code>bash $ cd output-dryrun $ private-key.bat $ public-key.bat</code></p> </li> </ol> <p>Confirming the conversion worked:</p> <div class="language-text highlight"><pre><span></span><code>```bash
$ ls -l 

private-key.asn1
private-key.bat
private-key.der
private-key.pem
public-key.bat
public-rsa-cert-01.asn1
public-rsa-cert-01.der
'RSA_AWS IoT Certificate.cer'
```
</code></pre></div> <div class="admonition info"> <p class=admonition-title>Info</p> <p><code>public-rsa-cert-01.der</code> is essentially useless, but does contain the public key of the certs in the Root Cert Store. The Root Cert Store actually strips out most of the content of the Root CA certificates that are inserted into it, keeping only the public key.</p> </div> <hr> <h3 id=confirm-extracted-certificates>Confirm Extracted Certificates<a class=headerlink href=#confirm-extracted-certificates title="Permanent link">¶</a></h3> <ol> <li> <p>Clear out the device</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-9-1><a href=#__codelineno-9-1 id=__codelineno-9-1 name=__codelineno-9-1></a>$<span class=w> </span>atwinc1500_fwtool.exe<span class=w> </span>erase<span class=w> </span>--root<span class=w> </span>--tls
</span></code></pre></div> </li> <li> <p>Upload extracted AWS Certs</p> <p>```bash $ atwinc1500_fwtool.exe update --tls --key output-dryrun\private-key.pem --cert output-dryrun\"RSA_AWS IoT Certificate.cer" </p> <p>$ atwinc1500_fwtool.exe update --root --ca_dir connect_device_package ```</p> </li> <li> <p>Confirm AWS IoT Connectivity using AWS_IoT_WiFi sketch</p> </li> </ol> <hr> <h3 id=validate-ioxy-setup>Validate IOXY Setup<a class=headerlink href=#validate-ioxy-setup title="Permanent link">¶</a></h3> <ol> <li>Upload SerialBridge sketch to device</li> <li> <p>Upload IOXY RootCA certificate </p> <p><code>certs</code> contains <code>rootCA.cer</code> which is generated by the IOXY <code>genCert.sh</code> script.</p> <p>We use the <code>--erase</code> flag to clear out the Root Cert Store before uploading the cert.</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-10-1><a href=#__codelineno-10-1 id=__codelineno-10-1 name=__codelineno-10-1></a>$<span class=w> </span>atwinc1500_fwtool.exe<span class=w> </span>update<span class=w> </span>--root<span class=w> </span>--erase<span class=w> </span>--ca_dir<span class=w> </span>certs
</span></code></pre></div> <p>What's interesting is that we don't have to actually replace the device AWS private key and certificate, all we have to do is add the self-signed IOXY Root CA certificate to the Root Cert Store.</p> </li> </ol> <div class="language-bash highlight"><pre><span></span><code><span id=__span-11-1><a href=#__codelineno-11-1 id=__codelineno-11-1 name=__codelineno-11-1></a>$<span class=w> </span>atwinc1500_fwtool.exe<span class=w> </span><span class=nb>read</span>
</span><span id=__span-11-2><a href=#__codelineno-11-2 id=__codelineno-11-2 name=__codelineno-11-2></a>
</span><span id=__span-11-3><a href=#__codelineno-11-3 id=__codelineno-11-3 name=__codelineno-11-3></a>Dumping<span class=w> </span>TLS<span class=w> </span>Store<span class=w> </span>contents...
</span><span id=__span-11-4><a href=#__codelineno-11-4 id=__codelineno-11-4 name=__codelineno-11-4></a>TLS<span class=w> </span>Certificate<span class=w> </span>Store<span class=w> </span>Loaded<span class=w> </span>Successfully<span class=w> </span>From:<span class=w> </span>Flash
</span><span id=__span-11-5><a href=#__codelineno-11-5 id=__codelineno-11-5 name=__codelineno-11-5></a>Found<span class=w> </span><span class=m>3</span><span class=w> </span>entries...
</span><span id=__span-11-6><a href=#__codelineno-11-6 id=__codelineno-11-6 name=__codelineno-11-6></a>-<span class=w> </span>RSA<span class=w> </span>Certificate<span class=w> </span>Chain<span class=w> </span>File<span class=w> </span>List
</span><span id=__span-11-7><a href=#__codelineno-11-7 id=__codelineno-11-7 name=__codelineno-11-7></a><span class=w>  </span>NAME<span class=w>                                             </span>SIZE<span class=w> </span>TYPE<span class=w>         </span>INFO
</span><span id=__span-11-8><a href=#__codelineno-11-8 id=__codelineno-11-8 name=__codelineno-11-8></a><span class=w>  </span>PRIV_62a1f32e421df7f65e2290155189f76dbd6953bd<span class=w>    </span><span class=m>1208</span><span class=w> </span>PRIVATE<span class=w> </span>KEY
</span><span id=__span-11-9><a href=#__codelineno-11-9 id=__codelineno-11-9 name=__codelineno-11-9></a><span class=w>  </span>CERT_62a1f32e421df7f65e2290155189f76dbd6953bd<span class=w>     </span><span class=m>861</span><span class=w> </span>CERTIFICATE<span class=w>  </span>AWS<span class=w> </span>IoT<span class=w> </span>Certificate
</span><span id=__span-11-10><a href=#__codelineno-11-10 id=__codelineno-11-10 name=__codelineno-11-10></a>-<span class=w> </span>Private<span class=w> </span>Key<span class=w> </span>Details:
</span><span id=__span-11-11><a href=#__codelineno-11-11 id=__codelineno-11-11 name=__codelineno-11-11></a><span class=w>  </span>Modulus<span class=w> </span><span class=o>(</span>N<span class=o>)</span><span class=w> </span>:<span class=o>(</span>00E09DA4<span class=o>)(</span><span class=m>256</span><span class=o>)</span>
</span><span id=__span-11-12><a href=#__codelineno-11-12 id=__codelineno-11-12 name=__codelineno-11-12></a><span class=w>        </span>A9<span class=w> </span><span class=m>34</span><span class=w> </span>C5<span class=w> </span>DD<span class=w> </span>7F<span class=w> </span><span class=m>50</span><span class=w> </span>C2<span class=w> </span><span class=m>23</span><span class=w> </span><span class=m>90</span><span class=w> </span>AA<span class=w> </span><span class=m>85</span><span class=w> </span>5B<span class=w> </span>DA<span class=w> </span>EC<span class=w> </span><span class=m>23</span><span class=w> </span><span class=m>80</span>
</span><span id=__span-11-13><a href=#__codelineno-11-13 id=__codelineno-11-13 name=__codelineno-11-13></a><span class=w>        </span><span class=m>09</span><span class=w> </span>AB<span class=w> </span>E7<span class=w> </span>B8<span class=w> </span>1E<span class=w> </span>1F<span class=w> </span><span class=m>66</span><span class=w> </span>1C<span class=w> </span><span class=m>37</span><span class=w> </span>9E<span class=w> </span>3A<span class=w> </span><span class=m>28</span><span class=w> </span>BB<span class=w> </span>9D<span class=w> </span><span class=m>07</span><span class=w> </span>6C
</span><span id=__span-11-14><a href=#__codelineno-11-14 id=__codelineno-11-14 name=__codelineno-11-14></a><span class=w>        </span>AE<span class=w> </span>D9<span class=w> </span><span class=m>50</span><span class=w> </span>5C<span class=w> </span><span class=m>45</span><span class=w> </span>D8<span class=w> </span>F1<span class=w> </span>5A<span class=w> </span><span class=m>09</span><span class=w> </span>4A<span class=w> </span><span class=m>44</span><span class=w> </span>A1<span class=w> </span><span class=m>56</span><span class=w> </span>1F<span class=w> </span>A6<span class=w> </span><span class=m>41</span>
</span><span id=__span-11-15><a href=#__codelineno-11-15 id=__codelineno-11-15 name=__codelineno-11-15></a><span class=w>        </span>4C<span class=w> </span>B4<span class=w> </span><span class=m>20</span><span class=w> </span>2D<span class=w> </span>D9<span class=w> </span>0F<span class=w> </span><span class=m>78</span><span class=w> </span><span class=m>68</span><span class=w> </span>E7<span class=w> </span>6E<span class=w> </span><span class=m>11</span><span class=w> </span><span class=m>61</span><span class=w> </span><span class=m>94</span><span class=w> </span><span class=m>54</span><span class=w> </span><span class=m>70</span><span class=w> </span><span class=m>13</span>
</span><span id=__span-11-16><a href=#__codelineno-11-16 id=__codelineno-11-16 name=__codelineno-11-16></a><span class=w>        </span>DF<span class=w> </span>A0<span class=w> </span><span class=m>86</span><span class=w> </span><span class=m>38</span><span class=w> </span>BC<span class=w> </span>0F<span class=w> </span>9E<span class=w> </span><span class=m>09</span><span class=w> </span>B0<span class=w> </span><span class=m>04</span><span class=w> </span><span class=m>39</span><span class=w> </span><span class=m>53</span><span class=w> </span>F2<span class=w> </span><span class=m>29</span><span class=w> </span><span class=m>35</span><span class=w> </span>BF
</span><span id=__span-11-17><a href=#__codelineno-11-17 id=__codelineno-11-17 name=__codelineno-11-17></a><span class=w>        </span>8E<span class=w> </span>FA<span class=w> </span><span class=m>19</span><span class=w> </span><span class=m>97</span><span class=w> </span><span class=m>86</span><span class=w> </span><span class=m>40</span><span class=w> </span><span class=m>74</span><span class=w> </span>3C<span class=w> </span><span class=m>20</span><span class=w> </span><span class=m>79</span><span class=w> </span>B9<span class=w> </span>0F<span class=w> </span>2A<span class=w> </span>1E<span class=w> </span>7A<span class=w> </span><span class=m>01</span>
</span><span id=__span-11-18><a href=#__codelineno-11-18 id=__codelineno-11-18 name=__codelineno-11-18></a><span class=w>        </span>F5<span class=w> </span><span class=m>55</span><span class=w> </span>C2<span class=w> </span>BB<span class=w> </span>CE<span class=w> </span>F6<span class=w> </span>7A<span class=w> </span>AA<span class=w> </span><span class=m>14</span><span class=w> </span><span class=m>48</span><span class=w> </span>BB<span class=w> </span><span class=m>77</span><span class=w> </span><span class=m>92</span><span class=w> </span>AB<span class=w> </span>0E<span class=w> </span>6D
</span><span id=__span-11-19><a href=#__codelineno-11-19 id=__codelineno-11-19 name=__codelineno-11-19></a><span class=w>        </span>C2<span class=w> </span>FE<span class=w> </span>6C<span class=w> </span><span class=m>62</span><span class=w> </span>F6<span class=w> </span>DD<span class=w> </span><span class=m>76</span><span class=w> </span><span class=m>90</span><span class=w> </span><span class=m>63</span><span class=w> </span><span class=m>40</span><span class=w> </span>C8<span class=w> </span><span class=m>58</span><span class=w> </span>2F<span class=w> </span>4F<span class=w> </span>D6<span class=w> </span>B1
</span><span id=__span-11-20><a href=#__codelineno-11-20 id=__codelineno-11-20 name=__codelineno-11-20></a><span class=w>        </span><span class=m>87</span><span class=w> </span><span class=m>09</span><span class=w> </span>CF<span class=w> </span>C7<span class=w> </span><span class=m>40</span><span class=w> </span><span class=m>34</span><span class=w> </span><span class=m>24</span><span class=w> </span>E7<span class=w> </span><span class=m>26</span><span class=w> </span>C1<span class=w> </span>BB<span class=w> </span><span class=m>29</span><span class=w> </span>F5<span class=w> </span><span class=m>45</span><span class=w> </span>C1<span class=w> </span>7D
</span><span id=__span-11-21><a href=#__codelineno-11-21 id=__codelineno-11-21 name=__codelineno-11-21></a><span class=w>        </span><span class=m>75</span><span class=w> </span>4D<span class=w> </span><span class=m>79</span><span class=w> </span>4A<span class=w> </span>C0<span class=w> </span>F7<span class=w> </span><span class=m>78</span><span class=w> </span>FA<span class=w> </span>EA<span class=w> </span>7F<span class=w> </span>3F<span class=w> </span><span class=m>44</span><span class=w> </span>DA<span class=w> </span>F8<span class=w> </span>BE<span class=w> </span>D0
</span><span id=__span-11-22><a href=#__codelineno-11-22 id=__codelineno-11-22 name=__codelineno-11-22></a><span class=w>        </span><span class=m>17</span><span class=w> </span>3D<span class=w> </span>9E<span class=w> </span>FF<span class=w> </span>0C<span class=w> </span>BF<span class=w> </span>F9<span class=w> </span>B6<span class=w> </span>C4<span class=w> </span><span class=m>06</span><span class=w> </span>5F<span class=w> </span><span class=m>12</span><span class=w> </span><span class=m>88</span><span class=w> </span>7C<span class=w> </span>C2<span class=w> </span>9F
</span><span id=__span-11-23><a href=#__codelineno-11-23 id=__codelineno-11-23 name=__codelineno-11-23></a><span class=w>        </span>B8<span class=w> </span><span class=m>82</span><span class=w> </span>D3<span class=w> </span>E2<span class=w> </span><span class=m>21</span><span class=w> </span>A9<span class=w> </span><span class=m>73</span><span class=w> </span><span class=m>72</span><span class=w> </span>AC<span class=w> </span><span class=m>09</span><span class=w> </span>9B<span class=w> </span>2B<span class=w> </span>4F<span class=w> </span><span class=m>91</span><span class=w> </span>8A<span class=w> </span>2D
</span><span id=__span-11-24><a href=#__codelineno-11-24 id=__codelineno-11-24 name=__codelineno-11-24></a><span class=w>        </span>E6<span class=w> </span>5F<span class=w> </span>A0<span class=w> </span><span class=m>83</span><span class=w> </span><span class=m>73</span><span class=w> </span><span class=m>82</span><span class=w> </span><span class=m>56</span><span class=w> </span>5D<span class=w> </span>4E<span class=w> </span>6C<span class=w> </span><span class=m>85</span><span class=w> </span>A9<span class=w> </span><span class=m>43</span><span class=w> </span><span class=m>87</span><span class=w> </span><span class=m>74</span><span class=w> </span><span class=m>81</span>
</span><span id=__span-11-25><a href=#__codelineno-11-25 id=__codelineno-11-25 name=__codelineno-11-25></a><span class=w>        </span>2A<span class=w> </span>B3<span class=w> </span><span class=m>47</span><span class=w> </span>D5<span class=w> </span>E2<span class=w> </span><span class=m>18</span><span class=w> </span>F8<span class=w> </span><span class=m>39</span><span class=w> </span>FC<span class=w> </span><span class=m>66</span><span class=w> </span>1A<span class=w> </span>5B<span class=w> </span>D2<span class=w> </span>C4<span class=w> </span><span class=m>06</span><span class=w> </span><span class=m>24</span>
</span><span id=__span-11-26><a href=#__codelineno-11-26 id=__codelineno-11-26 name=__codelineno-11-26></a><span class=w>        </span>CC<span class=w> </span>4C<span class=w> </span>0E<span class=w> </span>BF<span class=w> </span><span class=m>49</span><span class=w> </span>2A<span class=w> </span><span class=m>90</span><span class=w> </span>3D<span class=w> </span>0F<span class=w> </span><span class=m>47</span><span class=w> </span><span class=m>12</span><span class=w> </span><span class=m>16</span><span class=w> </span><span class=m>52</span><span class=w> </span>F0<span class=w> </span>5E<span class=w> </span>B7
</span><span id=__span-11-27><a href=#__codelineno-11-27 id=__codelineno-11-27 name=__codelineno-11-27></a><span class=w>        </span>4A<span class=w> </span>3E<span class=w> </span>F4<span class=w> </span><span class=m>76</span><span class=w> </span><span class=m>02</span><span class=w> </span>6E<span class=w> </span><span class=m>64</span><span class=w> </span>C0<span class=w> </span><span class=m>16</span><span class=w> </span>0B<span class=w> </span><span class=m>14</span><span class=w> </span>A7<span class=w> </span><span class=m>93</span><span class=w> </span><span class=m>90</span><span class=w> </span><span class=m>58</span><span class=w> </span><span class=m>99</span>
</span><span id=__span-11-28><a href=#__codelineno-11-28 id=__codelineno-11-28 name=__codelineno-11-28></a>
</span><span id=__span-11-29><a href=#__codelineno-11-29 id=__codelineno-11-29 name=__codelineno-11-29></a>-<span class=w> </span>TLS<span class=w> </span>Certificate<span class=w> </span>Details:
</span><span id=__span-11-30><a href=#__codelineno-11-30 id=__codelineno-11-30 name=__codelineno-11-30></a><span class=w>    </span>Subject<span class=w> </span>&lt;AWS<span class=w> </span>IoT<span class=w> </span>Certificate&gt;
</span><span id=__span-11-31><a href=#__codelineno-11-31 id=__codelineno-11-31 name=__codelineno-11-31></a><span class=w>    </span>Issuer<span class=w>  </span>&lt;<span class=w> </span>&gt;
</span><span id=__span-11-32><a href=#__codelineno-11-32 id=__codelineno-11-32 name=__codelineno-11-32></a><span class=w>    </span>&lt;<span class=m>2023</span>-03-23<span class=w> </span><span class=m>12</span>:47:18&gt;<span class=w> </span>to<span class=w> </span>&lt;<span class=m>2049</span>-12-31<span class=w> </span><span class=m>23</span>:59:59&gt;
</span><span id=__span-11-33><a href=#__codelineno-11-33 id=__codelineno-11-33 name=__codelineno-11-33></a>
</span><span id=__span-11-34><a href=#__codelineno-11-34 id=__codelineno-11-34 name=__codelineno-11-34></a>Dumping<span class=w> </span>Root<span class=w> </span>Cert<span class=w> </span>Store<span class=w> </span>contents...
</span><span id=__span-11-35><a href=#__codelineno-11-35 id=__codelineno-11-35 name=__codelineno-11-35></a>Root<span class=w> </span>Certificate<span class=w> </span>Store<span class=w> </span>Loaded<span class=w> </span>Successfully<span class=w> </span>From:<span class=w> </span>Flash
</span><span id=__span-11-36><a href=#__codelineno-11-36 id=__codelineno-11-36 name=__codelineno-11-36></a>Found<span class=w> </span><span class=m>3</span><span class=w> </span>entries:
</span><span id=__span-11-37><a href=#__codelineno-11-37 id=__codelineno-11-37 name=__codelineno-11-37></a><span class=m>1</span><span class=o>)</span><span class=w> </span>RSA<span class=w> </span>Certificate:<span class=w> </span><span class=m>5</span>/26/2015<span class=w> </span><span class=o>[</span><span class=m>00</span>:00:00<span class=o>]</span><span class=w> </span>to<span class=w> </span><span class=m>1</span>/17/2038<span class=w> </span><span class=o>[</span><span class=m>00</span>:00:00<span class=o>]</span>
</span><span id=__span-11-38><a href=#__codelineno-11-38 id=__codelineno-11-38 name=__codelineno-11-38></a><span class=w>   </span>Name<span class=w> </span>Hash<span class=w> </span><span class=o>(</span>SHA1<span class=o>)</span>:<span class=w> </span>A8<span class=w> </span><span class=m>66</span><span class=w> </span><span class=m>80</span><span class=w> </span>C4<span class=w> </span><span class=m>56</span><span class=w> </span><span class=m>27</span><span class=w> </span>2E<span class=w> </span>AF<span class=w> </span>E3<span class=w> </span>A7<span class=w> </span>CE<span class=w> </span>2E<span class=w> </span><span class=m>49</span><span class=w> </span>D1<span class=w> </span><span class=m>31</span><span class=w> </span>DC<span class=w> </span><span class=m>65</span><span class=w> </span>BB<span class=w> </span>B1<span class=w> </span>ED
</span><span id=__span-11-39><a href=#__codelineno-11-39 id=__codelineno-11-39 name=__codelineno-11-39></a><span class=m>2</span><span class=o>)</span><span class=w> </span>RSA<span class=w> </span>Certificate:<span class=w> </span><span class=m>3</span>/19/2023<span class=w> </span><span class=o>[</span><span class=m>20</span>:00:22<span class=o>]</span><span class=w> </span>to<span class=w> </span><span class=m>3</span>/18/2033<span class=w> </span><span class=o>[</span><span class=m>20</span>:00:22<span class=o>]</span>
</span><span id=__span-11-40><a href=#__codelineno-11-40 id=__codelineno-11-40 name=__codelineno-11-40></a><span class=w>   </span>Name<span class=w> </span>Hash<span class=w> </span><span class=o>(</span>SHA1<span class=o>)</span>:<span class=w> </span><span class=m>14</span><span class=w> </span><span class=m>65</span><span class=w> </span><span class=m>65</span><span class=w> </span><span class=m>22</span><span class=w> </span><span class=m>40</span><span class=w> </span>7A<span class=w> </span>D1<span class=w> </span><span class=m>30</span><span class=w> </span><span class=m>64</span><span class=w> </span><span class=m>06</span><span class=w> </span>9E<span class=w> </span><span class=m>87</span><span class=w> </span>AD<span class=w> </span>BB<span class=w> </span>C5<span class=w> </span><span class=m>31</span><span class=w> </span>7D<span class=w> </span><span class=m>37</span><span class=w> </span><span class=m>94</span><span class=w> </span>FF
</span><span id=__span-11-41><a href=#__codelineno-11-41 id=__codelineno-11-41 name=__codelineno-11-41></a><span class=m>3</span><span class=o>)</span><span class=w> </span>RSA<span class=w> </span>Certificate:<span class=w> </span><span class=m>3</span>/24/2023<span class=w> </span><span class=o>[</span><span class=m>04</span>:48:33<span class=o>]</span><span class=w> </span>to<span class=w> </span><span class=m>1</span>/11/2026<span class=w> </span><span class=o>[</span><span class=m>04</span>:48:33<span class=o>]</span>
</span><span id=__span-11-42><a href=#__codelineno-11-42 id=__codelineno-11-42 name=__codelineno-11-42></a><span class=w>   </span>Name<span class=w> </span>Hash<span class=w> </span><span class=o>(</span>SHA1<span class=o>)</span>:<span class=w> </span><span class=m>85</span><span class=w> </span>E9<span class=w> </span><span class=m>39</span><span class=w> </span>C3<span class=w> </span><span class=m>32</span><span class=w> </span>E4<span class=w> </span><span class=m>60</span><span class=w> </span>1F<span class=w> </span>7E<span class=w> </span><span class=m>69</span><span class=w> </span>9A<span class=w> </span>5F<span class=w> </span><span class=m>49</span><span class=w> </span><span class=m>99</span><span class=w> </span><span class=m>76</span><span class=w> </span><span class=m>39</span><span class=w> </span>FC<span class=w> </span>BB<span class=w> </span>D9<span class=w> </span><span class=m>87</span>
</span></code></pre></div> <ol start=3> <li>Confirm AWS IoT Connectivity using AWS_IoT_WiFi sketch</li> </ol> <p>It works!</p> <hr> <h2 id=doing-it-live>Doing it Live<a class=headerlink href=#doing-it-live title="Permanent link">¶</a></h2> <div class="language-text highlight"><pre><span></span><code><span id=__span-12-1><a href=#__codelineno-12-1 id=__codelineno-12-1 name=__codelineno-12-1></a>atwinc1500_fwtool.exe  update --erase --key ioxy-certs-final\devices\d1\d1.key --cert ioxy-certs-final\devices\d1\d1.cer --tls
</span></code></pre></div> <p><br></p> <div class=blogging-tags-grid> <a class=blogging-tag href=https://samrambles.com/tags#microchip><code>#microchip</code></a> <a class=blogging-tag href=https://samrambles.com/tags#firmware><code>#firmware</code></a> <a class=blogging-tag href=https://samrambles.com/tags#analysis><code>#analysis</code></a> <a class=blogging-tag href=https://samrambles.com/tags#uC><code>#uC</code></a> </div> <style>
    .md-typeset .blogging-tags-grid {
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
        gap: 8px;
        margin-top: 5px;
    }

    .md-typeset .blogging-tag {
        color: var(--md-typeset-color);
        background-color: var(--md-typeset-code-color);
    }

    .md-typeset .blogging-tag code {
        border-radius: 5px;
    }
</style></div> <hr> <div class=md-source-file> <small> Last update: 2023-03-30 </small> </div> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> </div> <a class="md-top md-icon" data-md-component=top hidden href=#> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg> Back to top </a> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Made with ❤️ by Sam. </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ rel=noopener target=_blank> Material for MkDocs </a> </div> <div class=md-social> <a class=md-social__link href=https://github.com/peddamat rel=noopener target=_blank title=github.com> <svg viewbox="0 0 480 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg> </a> <a class=md-social__link href=https://twitter.com/peddamat rel=noopener target=_blank title=twitter.com> <svg viewbox="0 0 512 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg> </a> <a class=md-social__link href=https://www.instagram.com/speddamat rel=noopener target=_blank title=www.instagram.com> <svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"></path></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["announce.dismiss", "header.autohide", "search.share", "search.highlight", "search.suggest", "content.code.copy", "content.code.select", "content.code.annotate", "content.tabs.link", "navigation.tracking", "navigation.top", "navigation.sections", "navigation.tabs", "navigation.indexes"], "search": "../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../../assets/javascripts/bundle.2a6f1dda.min.js></script> <script src=../../../assests/scripts/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": false, "openEffect": "none", "closeEffect": "none", "slideEffect": "none"});})</script></body> </html>